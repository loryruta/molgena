\usepackage{amsmath,amsfonts}
\allowdisplaybreaks
\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\x}{\mathbf{x}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\z}{\mathbf{z}}
\newcommand{\h}{\mathbf{h}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\U}{\mathbf{U}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\f}{\mathbf{f}}
\newcommand{\m}{\mathbf{m}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\calV}{\mathcal{V}}
\newcommand{\calE}{\mathcal{E}}
\newcommand{\bnu}{\boldsymbol\nu}
\newcommand{\bmu}{\boldsymbol\mu}
\newcommand{\bsigma}{\boldsymbol\sigma}
\newcommand{\bgamma}{\boldsymbol\gamma}

\newcommand{\tree}{\mathcal{T}}
\newcommand{\GRU}{\text{GRU}}
\newcommand{\softmax}{\text{softmax}}
\newcommand{\loss}{\mathcal{L}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\prior}{\mathcal{N}(\mbf{0},\mbf{I})}
\newcommand{\E}[2]{\mathbb{E}_{#1}\left[#2\right]}
\newcommand{\len}[1]{\vert #1 \vert}

\newtheorem{theo}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{fact}{Fact}
\newtheorem{defn}{Definition}

\newcommand\Tstrut{\rule{0pt}{2.3ex}}
\newcommand\Bstrut{\rule[-0.9ex]{0pt}{0pt}}